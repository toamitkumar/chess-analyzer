{"ast":null,"code":"import _asyncToGenerator from \"/Users/amit.kumar3/projects/chess-analysis/chessify/newfrontend/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport { LayoutComponent } from '../../components/layout/layout.component';\nimport { StatCardComponent } from '../../components/stat-card/stat-card.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/chess-api.service\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = () => [];\nfunction TournamentDetailComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵelement(1, \"app-stat-card\", 25)(2, \"app-stat-card\", 26)(3, \"app-stat-card\", 27)(4, \"app-stat-card\", 28);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate3(\"subtitle\", \"\", ctx_r0.getWins(), \"W \", ctx_r0.getDraws(), \"D \", ctx_r0.getLosses(), \"L\");\n    i0.ɵɵproperty(\"value\", ctx_r0.getScore() + \" / \" + ((ctx_r0.tournament == null ? null : ctx_r0.tournament.games == null ? null : ctx_r0.tournament.games.length) || 0));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"value\", ctx_r0.getWinRate() + \"%\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"value\", ctx_r0.getAvgAccuracy() + \"%\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"value\", ctx_r0.getTotalBlunders());\n  }\n}\nfunction TournamentDetailComponent_div_27_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 47);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(1, \"svg\", 36);\n    i0.ɵɵelement(2, \"path\", 48)(3, \"path\", 49)(4, \"path\", 50);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const game_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate2(\" \", game_r3.blunders, \" blunder\", game_r3.blunders > 1 ? \"s\" : \"\", \" \");\n  }\n}\nfunction TournamentDetailComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵlistener(\"click\", function TournamentDetailComponent_div_27_Template_div_click_0_listener() {\n      const game_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.navigateToGame(game_r3.id));\n    });\n    i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 30)(3, \"span\", 31);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 32)(6, \"div\", 7)(7, \"span\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 33);\n    i0.ɵɵtext(10, \"vs\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"span\", 34);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 35)(14, \"div\");\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(15, \"svg\", 36);\n    i0.ɵɵelement(16, \"path\", 37)(17, \"path\", 38);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(18, \"div\", 39)(19, \"span\");\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"div\", 35);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(22, \"svg\", 36);\n    i0.ɵɵelement(23, \"circle\", 40)(24, \"circle\", 41)(25, \"circle\", 42);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(27, TournamentDetailComponent_div_27_div_27_Template, 6, 2, \"div\", 43);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵnamespaceHTML();\n    i0.ɵɵelementStart(28, \"button\", 44);\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(29, \"svg\", 45);\n    i0.ɵɵelement(30, \"path\", 46);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const game_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"R\", game_r3.round, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassMap(\"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium \" + ctx_r0.getResultBadgeClass(game_r3.result, game_r3.playerColor));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.getResultText(game_r3.result, game_r3.playerColor), \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(game_r3.opponent);\n    i0.ɵɵadvance(2);\n    i0.ɵɵclassMap(\"h-4 w-4 rounded-full flex items-center justify-center \" + (game_r3.playerColor === \"white\" ? \"bg-muted\" : \"bg-secondary\"));\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(game_r3.opening);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate1(\" \", game_r3.accuracy, \"% accuracy \");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", game_r3.blunders > 0);\n  }\n}\nexport let TournamentDetailComponent = /*#__PURE__*/(() => {\n  class TournamentDetailComponent {\n    constructor(route, router, chessApi) {\n      this.route = route;\n      this.router = router;\n      this.chessApi = chessApi;\n      this.tournamentId = null;\n      this.tournament = null;\n      this.loading = true;\n      this.error = null;\n    }\n    ngOnInit() {\n      const id = this.route.snapshot.paramMap.get('id');\n      if (id) {\n        this.tournamentId = parseInt(id);\n        this.loadTournamentData();\n      }\n    }\n    loadTournamentData() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (!_this.tournamentId) return;\n        _this.loading = true;\n        _this.error = null;\n        try {\n          // Load tournament details and games (games now include pre-calculated accuracy from BE)\n          const [tournamentData, games] = yield Promise.all([_this.chessApi.getTournamentById(_this.tournamentId).toPromise(), _this.chessApi.getTournamentGames(_this.tournamentId).toPromise()]);\n          // Process games to add round numbers and opponent info (accuracy comes from BE)\n          const processedGames = games.map((game, index) => {\n            const targetPlayer = _this.chessApi.targetPlayer;\n            const isPlayerWhite = game.white_player === targetPlayer;\n            const opponent = isPlayerWhite ? game.black_player : game.white_player;\n            return {\n              ...game,\n              opponent,\n              round: index + 1 // Simple round numbering\n              // accuracy and blunders now come from BE\n              // playerColor now comes from BE\n            };\n          });\n          _this.tournament = {\n            ...tournamentData,\n            games: processedGames\n          };\n          _this.loading = false;\n        } catch (err) {\n          _this.error = err.message || 'Failed to load tournament data';\n          _this.loading = false;\n          console.error('Error loading tournament:', err);\n        }\n      })();\n    }\n    getAvgAccuracy() {\n      if (!this.tournament || this.tournament.games.length === 0) return '0.0';\n      // Use BE-calculated accuracy values (no FE calculation)\n      const gamesWithAccuracy = this.tournament.games.filter(g => g.accuracy && g.accuracy > 0);\n      if (gamesWithAccuracy.length === 0) return '0.0';\n      const avg = gamesWithAccuracy.reduce((sum, g) => sum + (g.accuracy || 0), 0) / gamesWithAccuracy.length;\n      return avg.toFixed(1);\n    }\n    getTotalBlunders() {\n      if (!this.tournament || this.tournament.games.length === 0) return 0;\n      return this.tournament.games.reduce((sum, g) => sum + (g.blunders || 0), 0);\n    }\n    formatDate(dateStr) {\n      // Convert \"2025.10.24\" format to readable date\n      const parts = dateStr.split('.');\n      if (parts.length === 3) {\n        const date = new Date(parseInt(parts[0]), parseInt(parts[1]) - 1, parseInt(parts[2]));\n        return date.toLocaleDateString();\n      }\n      return dateStr;\n    }\n    getResultBadgeClass(result, playerColor) {\n      const isWin = result === '1-0' && playerColor === 'white' || result === '0-1' && playerColor === 'black';\n      const isDraw = result === '1/2-1/2';\n      if (isWin) return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300';\n      if (isDraw) return 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300';\n      return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300';\n    }\n    getResultText(result, playerColor) {\n      const isWin = result === '1-0' && playerColor === 'white' || result === '0-1' && playerColor === 'black';\n      const isDraw = result === '1/2-1/2';\n      if (isWin) return 'Win';\n      if (isDraw) return 'Draw';\n      return 'Loss';\n    }\n    static {\n      this.ɵfac = function TournamentDetailComponent_Factory(t) {\n        return new (t || TournamentDetailComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ChessApiService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: TournamentDetailComponent,\n        selectors: [[\"app-tournament-detail\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 28,\n        vars: 5,\n        consts: [[1, \"space-y-6\"], [1, \"flex\", \"items-center\", \"gap-4\"], [1, \"inline-flex\", \"items-center\", \"justify-center\", \"rounded-md\", \"text-sm\", \"font-medium\", \"ring-offset-background\", \"transition-colors\", \"focus-visible:outline-none\", \"focus-visible:ring-2\", \"focus-visible:ring-ring\", \"focus-visible:ring-offset-2\", \"disabled:pointer-events-none\", \"disabled:opacity-50\", \"hover:bg-accent\", \"hover:text-accent-foreground\", \"h-10\", \"w-10\", 3, \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"16\", \"height\", \"16\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 1, \"h-4\", \"w-4\"], [\"d\", \"m12 19-7-7 7-7\"], [\"d\", \"M19 12H5\"], [1, \"flex-1\"], [1, \"flex\", \"items-center\", \"gap-2\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"24\", \"height\", \"24\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 1, \"h-6\", \"w-6\", \"text-primary\"], [\"d\", \"M6 9H4.5a2.5 2.5 0 0 1 0-5H6\"], [\"d\", \"M18 9h1.5a2.5 2.5 0 0 0 0-5H18\"], [\"d\", \"M4 22h16\"], [\"d\", \"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22\"], [\"d\", \"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22\"], [\"d\", \"M18 2H6v7a6 6 0 0 0 12 0V2Z\"], [1, \"text-3xl\", \"font-bold\", \"text-foreground\"], [1, \"text-muted-foreground\"], [\"class\", \"grid gap-4 md:grid-cols-2 lg:grid-cols-4\", 4, \"ngIf\"], [1, \"rounded-lg\", \"border\", \"bg-card\", \"text-card-foreground\", \"shadow-sm\"], [1, \"flex\", \"flex-col\", \"space-y-1.5\", \"p-6\"], [1, \"text-2xl\", \"font-semibold\", \"leading-none\", \"tracking-tight\"], [1, \"p-6\", \"pt-0\"], [1, \"space-y-3\"], [\"class\", \"flex items-center justify-between rounded-lg border p-4 transition-all hover:bg-muted/50 cursor-pointer\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"grid\", \"gap-4\", \"md:grid-cols-2\", \"lg:grid-cols-4\"], [\"title\", \"Tournament Score\", \"icon\", \"trophy\", 3, \"value\", \"subtitle\"], [\"title\", \"Win Rate\", \"subtitle\", \"Tournament performance\", \"icon\", \"trending-up\", 3, \"value\"], [\"title\", \"Avg Accuracy\", \"subtitle\", \"Average move accuracy\", \"icon\", \"target\", 3, \"value\"], [\"title\", \"Total Blunders\", \"subtitle\", \"Across all games\", \"icon\", \"alert-triangle\", 3, \"value\"], [1, \"flex\", \"items-center\", \"justify-between\", \"rounded-lg\", \"border\", \"p-4\", \"transition-all\", \"hover:bg-muted/50\", \"cursor-pointer\", 3, \"click\"], [1, \"flex\", \"h-10\", \"w-10\", \"items-center\", \"justify-center\", \"rounded-full\", \"bg-primary/10\"], [1, \"text-sm\", \"font-bold\", \"text-primary\"], [1, \"space-y-1\"], [1, \"text-sm\", \"text-muted-foreground\"], [1, \"font-medium\"], [1, \"flex\", \"items-center\", \"gap-1\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"12\", \"height\", \"12\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 1, \"h-3\", \"w-3\"], [\"d\", \"M2 20h20l-2-6-4 2-4-4-4 4-4-2z\"], [\"d\", \"M6 4l2 4 4-2 4 2 2-4\"], [1, \"flex\", \"items-center\", \"gap-3\", \"text-xs\", \"text-muted-foreground\"], [\"cx\", \"12\", \"cy\", \"12\", \"r\", \"10\"], [\"cx\", \"12\", \"cy\", \"12\", \"r\", \"6\"], [\"cx\", \"12\", \"cy\", \"12\", \"r\", \"2\"], [\"class\", \"flex items-center gap-1 text-yellow-600\", 4, \"ngIf\"], [1, \"inline-flex\", \"items-center\", \"justify-center\", \"rounded-md\", \"text-sm\", \"font-medium\", \"ring-offset-background\", \"transition-colors\", \"focus-visible:outline-none\", \"focus-visible:ring-2\", \"focus-visible:ring-ring\", \"focus-visible:ring-offset-2\", \"disabled:pointer-events-none\", \"disabled:opacity-50\", \"hover:bg-accent\", \"hover:text-accent-foreground\", \"h-10\", \"w-10\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"20\", \"height\", \"20\", \"viewBox\", \"0 0 24 24\", \"fill\", \"none\", \"stroke\", \"currentColor\", \"stroke-width\", \"2\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 1, \"h-5\", \"w-5\"], [\"d\", \"m9 18 6-6-6-6\"], [1, \"flex\", \"items-center\", \"gap-1\", \"text-yellow-600\"], [\"d\", \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z\"], [\"d\", \"M12 9v4\"], [\"d\", \"m12 17 .01 0\"]],\n        template: function TournamentDetailComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"app-layout\")(1, \"div\", 0)(2, \"div\", 1)(3, \"button\", 2);\n            i0.ɵɵlistener(\"click\", function TournamentDetailComponent_Template_button_click_3_listener() {\n              return ctx.goBack();\n            });\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(4, \"svg\", 3);\n            i0.ɵɵelement(5, \"path\", 4)(6, \"path\", 5);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(7, \"div\", 6)(8, \"div\", 7);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(9, \"svg\", 8);\n            i0.ɵɵelement(10, \"path\", 9)(11, \"path\", 10)(12, \"path\", 11)(13, \"path\", 12)(14, \"path\", 13)(15, \"path\", 14);\n            i0.ɵɵelementEnd();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(16, \"h1\", 15);\n            i0.ɵɵtext(17);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(18, \"p\", 16);\n            i0.ɵɵtext(19);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(20, TournamentDetailComponent_div_20_Template, 5, 8, \"div\", 17);\n            i0.ɵɵelementStart(21, \"div\", 18)(22, \"div\", 19)(23, \"h3\", 20);\n            i0.ɵɵtext(24, \"Round-by-Round Results\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(25, \"div\", 21)(26, \"div\", 22);\n            i0.ɵɵtemplate(27, TournamentDetailComponent_div_27_Template, 31, 10, \"div\", 23);\n            i0.ɵɵelementEnd()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(17);\n            i0.ɵɵtextInterpolate(ctx.tournamentName);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.dateRange);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.tournament && !ctx.loading);\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"ngForOf\", (ctx.tournament == null ? null : ctx.tournament.games) || i0.ɵɵpureFunction0(4, _c0));\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf, LayoutComponent, StatCardComponent],\n        encapsulation: 2\n      });\n    }\n  }\n  return TournamentDetailComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}