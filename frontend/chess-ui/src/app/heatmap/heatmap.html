<div class="heatmap-container">
  <mat-toolbar color="primary">
    <span>Chess Error Heatmap</span>
  </mat-toolbar>

  <div class="content">
    <p class="subtitle">Click on highlighted squares to see blunder details</p>

    <!-- Stats Cards -->
    <div class="stats-grid">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Total Blunders</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value error">{{ totalBlunders }}</div>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title>Most Problematic Square</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-value error">{{ worstSquare }}</div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Heatmap Board -->
    <mat-card class="board-card">
      <mat-card-content>
        <div class="chessboard">
          <div 
            *ngFor="let square of heatmapData; let i = index"
            class="chess-square"
            [class]="getSquareClass(square, i)"
            (click)="showSquareDetails(square)">
            {{ square.square }}
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Square Details -->
    <mat-card *ngIf="selectedSquare" class="details-card">
      <mat-card-header>
        <mat-card-title>Square Details</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="details-grid">
          <div>
            <strong>Square:</strong> {{ selectedSquare.square }}
          </div>
          <div>
            <strong>Blunders:</strong> {{ selectedSquare.count }}
          </div>
          <div>
            <strong>Total Severity:</strong> {{ selectedSquare.severity }}
          </div>
          <div>
            <strong>Average Severity:</strong> {{ getAverageSeverity(selectedSquare) }}
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
