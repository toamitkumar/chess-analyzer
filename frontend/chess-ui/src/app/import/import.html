<div class="import-container">
  <!-- Header -->
  <div class="import-header">
    <div class="header-content">
      <h1 class="import-title">üìÅ Import PGN Files</h1>
      <p class="import-subtitle">Upload your chess games for analysis and performance tracking</p>
    </div>
  </div>

  <div class="import-content">
    <!-- Tournament Selection -->
    <mat-card class="tournament-card">
      <mat-card-content class="tournament-content">
        <div class="tournament-header">
          <div class="tournament-info">
            <h3 class="tournament-title">
              <mat-icon>emoji_events</mat-icon>
              Tournament Assignment
            </h3>
            <p class="tournament-description">Choose a tournament or create a new one for your games</p>
          </div>
          
          <button mat-raised-button color="accent" (click)="openTournamentCreator()" class="create-btn">
            <mat-icon>add</mat-icon>
            Create Tournament
          </button>
        </div>
        
        <div class="tournament-selector">
          <app-tournament-selector 
            [selectedTournamentId]="selectedTournamentId"
            (tournamentChange)="onTournamentChange($event)">
          </app-tournament-selector>
        </div>
        
        <div class="tournament-help">
          <mat-icon class="help-icon">info</mat-icon>
          <span>{{ selectedTournamentId ? 'PGN files will be assigned to the selected tournament.' : 'PGN files will be auto-assigned based on Event headers.' }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Upload Area -->
    <mat-card 
      class="upload-card"
      [class.dragover]="isDragOver"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)">
      
      <mat-card-content class="upload-content">
        <div class="upload-visual">
          <mat-icon class="upload-icon">cloud_upload</mat-icon>
          <div class="upload-animation"></div>
        </div>
        
        <h3 class="upload-title">Drop PGN files here</h3>
        <p class="upload-description">or click to browse and select files</p>
        
        <div class="upload-features">
          <div class="feature">
            <mat-icon>check</mat-icon>
            <span>Multiple files supported</span>
          </div>
          <div class="feature">
            <mat-icon>check</mat-icon>
            <span>Automatic game detection</span>
          </div>
          <div class="feature">
            <mat-icon>check</mat-icon>
            <span>Tournament organization</span>
          </div>
        </div>
        
        <button mat-raised-button color="primary" (click)="fileInput.click()" class="select-btn">
          <mat-icon>folder_open</mat-icon>
          Select PGN Files
        </button>
        
        <input 
          #fileInput
          type="file" 
          accept=".pgn" 
          multiple 
          style="display: none"
          (change)="onFileSelect($event)">
      </mat-card-content>
    </mat-card>

    <!-- Progress Section -->
    <mat-card *ngIf="isUploading" class="progress-card">
      <mat-card-content class="progress-content">
        <div class="progress-header">
          <div class="progress-info">
            <mat-icon class="progress-icon">upload</mat-icon>
            <div>
              <h4>Processing files...</h4>
              <p>Analyzing games and extracting data</p>
            </div>
          </div>
          <div class="progress-percentage">{{ uploadProgress }}%</div>
        </div>
        <mat-progress-bar [value]="uploadProgress" class="progress-bar"></mat-progress-bar>
      </mat-card-content>
    </mat-card>

    <!-- Results Section -->
    <div *ngIf="results.length > 0" class="results-section">
      <h2 class="results-title">
        <mat-icon>assessment</mat-icon>
        Import Results
      </h2>
      
      <div class="results-grid">
        <mat-card 
          *ngFor="let result of results"
          class="result-card"
          [class.success]="result.success"
          [class.error]="!result.success">
          
          <mat-card-content class="result-content">
            <div class="result-header">
              <div class="result-status">
                <mat-icon [class.success-icon]="result.success" [class.error-icon]="!result.success">
                  {{ result.success ? 'check_circle' : 'error' }}
                </mat-icon>
                <div class="result-info">
                  <h4 class="result-filename">{{ result.filename }}</h4>
                  <p class="result-message">{{ result.message }}</p>
                </div>
              </div>
            </div>
            
            <div *ngIf="result.success && result.games" class="result-details">
              <div class="result-stats">
                <div class="stat">
                  <span class="stat-value">{{ result.totalGames }}</span>
                  <span class="stat-label">Games</span>
                </div>
                <div class="stat">
                  <span class="stat-value">{{ result.games.length }}</span>
                  <span class="stat-label">Previews</span>
                </div>
              </div>
              
              <mat-expansion-panel class="games-panel">
                <mat-expansion-panel-header>
                  <mat-panel-title>
                    <mat-icon>visibility</mat-icon>
                    View Game Details
                  </mat-panel-title>
                </mat-expansion-panel-header>
                
                <div class="games-list">
                  <div *ngFor="let game of result.games" class="game-item">
                    <div class="game-players">
                      <strong>{{ game.white }}</strong> vs <strong>{{ game.black }}</strong>
                    </div>
                    <div class="game-meta">
                      <span class="game-result">{{ game.result }}</span>
                      <span class="game-date">{{ game.date }}</span>
                      <span class="game-moves">{{ game.moveCount }} moves</span>
                    </div>
                  </div>
                </div>
              </mat-expansion-panel>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </div>
</div>

<style>
.import-container {
  min-height: calc(100vh - 120px);
}

.import-header {
  margin-bottom: 2rem;
  padding: 2rem;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 20px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.import-title {
  margin: 0;
  font-size: 2rem;
  font-weight: 700;
  color: #333;
}

.import-subtitle {
  margin: 0.5rem 0 0 0;
  color: #666;
  font-size: 1rem;
}

.import-content {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.tournament-card {
  background: linear-gradient(135deg, #fff 0%, #f8fafc 100%) !important;
}

.tournament-content {
  padding: 2rem !important;
}

.tournament-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 1.5rem;
}

.tournament-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 0 0 0.5rem 0;
  font-size: 1.25rem;
  font-weight: 600;
  color: #333;
}

.tournament-description {
  margin: 0;
  color: #666;
  font-size: 0.875rem;
}

.create-btn {
  display: flex !important;
  align-items: center;
  gap: 0.5rem;
}

.tournament-help {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 1rem;
  background: rgba(102, 126, 234, 0.1);
  border-radius: 12px;
  color: #667eea;
  font-size: 0.875rem;
}

.help-icon {
  font-size: 1rem !important;
}

.upload-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  color: white !important;
  border: 2px dashed rgba(255, 255, 255, 0.3) !important;
  transition: all 0.3s ease !important;
  cursor: pointer;
}

.upload-card:hover, .upload-card.dragover {
  transform: translateY(-4px) !important;
  border-color: rgba(255, 255, 255, 0.6) !important;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2) !important;
}

.upload-content {
  text-align: center;
  padding: 3rem 2rem !important;
}

.upload-visual {
  position: relative;
  margin-bottom: 2rem;
}

.upload-icon {
  font-size: 4rem !important;
  width: 4rem !important;
  height: 4rem !important;
  color: rgba(255, 255, 255, 0.9);
}

.upload-title {
  margin: 0 0 0.5rem 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: white;
}

.upload-description {
  margin: 0 0 2rem 0;
  color: rgba(255, 255, 255, 0.8);
}

.upload-features {
  display: flex;
  justify-content: center;
  gap: 2rem;
  margin-bottom: 2rem;
}

.feature {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: rgba(255, 255, 255, 0.9);
  font-size: 0.875rem;
}

.select-btn {
  background: rgba(255, 255, 255, 0.2) !important;
  color: white !important;
  border: 1px solid rgba(255, 255, 255, 0.3) !important;
  backdrop-filter: blur(10px) !important;
  display: flex !important;
  align-items: center;
  gap: 0.5rem;
}

.select-btn:hover {
  background: rgba(255, 255, 255, 0.3) !important;
}

.progress-card {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
  color: white !important;
}

.progress-content {
  padding: 2rem !important;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.progress-info {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.progress-icon {
  font-size: 2rem !important;
  color: rgba(255, 255, 255, 0.9);
}

.progress-info h4 {
  margin: 0;
  font-size: 1.125rem;
  font-weight: 600;
}

.progress-info p {
  margin: 0;
  color: rgba(255, 255, 255, 0.8);
  font-size: 0.875rem;
}

.progress-percentage {
  font-size: 1.5rem;
  font-weight: 700;
}

.progress-bar {
  height: 8px !important;
  border-radius: 4px !important;
}

.results-section {
  margin-top: 2rem;
}

.results-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1.5rem;
  font-size: 1.5rem;
  font-weight: 600;
  color: #333;
}

.results-grid {
  display: grid;
  gap: 1rem;
}

.result-card {
  border-left: 4px solid transparent !important;
  transition: all 0.3s ease !important;
}

.result-card.success {
  border-left-color: #10b981 !important;
}

.result-card.error {
  border-left-color: #ef4444 !important;
}

.result-content {
  padding: 1.5rem !important;
}

.result-header {
  margin-bottom: 1rem;
}

.result-status {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
}

.success-icon {
  color: #10b981 !important;
  font-size: 1.5rem !important;
}

.error-icon {
  color: #ef4444 !important;
  font-size: 1.5rem !important;
}

.result-filename {
  margin: 0 0 0.25rem 0;
  font-size: 1rem;
  font-weight: 600;
  color: #333;
}

.result-message {
  margin: 0;
  color: #666;
  font-size: 0.875rem;
}

.result-stats {
  display: flex;
  gap: 2rem;
  margin-bottom: 1rem;
}

.stat {
  text-align: center;
}

.stat-value {
  display: block;
  font-size: 1.5rem;
  font-weight: 700;
  color: #333;
}

.stat-label {
  font-size: 0.75rem;
  color: #666;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.games-panel {
  margin-top: 1rem;
}

.games-list {
  display: grid;
  gap: 1rem;
  margin-top: 1rem;
}

.game-item {
  padding: 1rem;
  background: #f8fafc;
  border-radius: 8px;
  border-left: 3px solid #667eea;
}

.game-players {
  margin-bottom: 0.5rem;
  font-size: 0.875rem;
}

.game-meta {
  display: flex;
  gap: 1rem;
  font-size: 0.75rem;
  color: #666;
}

@media (max-width: 768px) {
  .import-header, .tournament-content, .upload-content, .progress-content {
    padding: 1rem !important;
  }
  
  .tournament-header {
    flex-direction: column;
    gap: 1rem;
  }
  
  .upload-features {
    flex-direction: column;
    gap: 1rem;
  }
  
  .progress-header {
    flex-direction: column;
    gap: 1rem;
    text-align: center;
  }
  
  .result-stats {
    justify-content: center;
  }
}
</style>
