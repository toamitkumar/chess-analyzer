<app-navigation></app-navigation>

<div class="import-layout">
  <div class="container">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1 class="page-title">Import PGN Files</h1>
        <p class="page-subtitle">Upload your chess games for detailed analysis and performance tracking</p>
      </div>
    </div>

    <!-- Tournament Selection -->
    <div class="tournament-section">
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title">
            <mat-icon>emoji_events</mat-icon>
            Tournament
          </h2>
          <button class="btn btn-primary" (click)="openTournamentCreator()">
            <mat-icon>add</mat-icon>
            Create New
          </button>
        </div>
        
        <div class="tournament-selector">
          <app-tournament-selector 
            [selectedTournamentId]="selectedTournamentId"
            (tournamentChange)="onTournamentChange($event)">
          </app-tournament-selector>
        </div>
      </div>
    </div>

    <!-- File Upload -->
    <div class="upload-section">
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title">
            <mat-icon>cloud_upload</mat-icon>
            Upload Files
          </h2>
        </div>
        
        <div class="upload-area" 
             [class.dragover]="isDragOver"
             (dragover)="onDragOver($event)"
             (dragleave)="onDragLeave($event)"
             (drop)="onDrop($event)">
          
          <div class="upload-icon">
            <mat-icon>cloud_upload</mat-icon>
          </div>
          
          <h3>Drop PGN files here</h3>
          <p>or click to browse files</p>
          
          <input type="file" 
                 #fileInput 
                 multiple 
                 accept=".pgn"
                 (change)="onFileSelected($event)"
                 style="display: none;">
          
          <button class="btn btn-primary" (click)="fileInput.click()">
            <mat-icon>folder_open</mat-icon>
            Choose Files
          </button>
        </div>
      </div>
    </div>

    <!-- Selected Files -->
    <div class="files-section" *ngIf="selectedFiles.length > 0">
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title">
            <mat-icon>description</mat-icon>
            Selected Files ({{ selectedFiles.length }})
          </h2>
          <div class="section-actions">
            <button class="btn btn-primary" 
                    [disabled]="uploading"
                    (click)="uploadFiles()">
              <mat-icon *ngIf="!uploading">upload</mat-icon>
              <mat-spinner *ngIf="uploading" diameter="20"></mat-spinner>
              {{ uploading ? 'Uploading...' : 'Upload Files' }}
            </button>
            <button class="btn btn-secondary" (click)="clearFiles()">
              <mat-icon>clear</mat-icon>
              Clear All
            </button>
          </div>
        </div>
        
        <div class="files-list">
          <div class="file-item" *ngFor="let file of selectedFiles; let i = index">
            <div class="file-info">
              <mat-icon class="file-icon">description</mat-icon>
              <div class="file-details">
                <div class="file-name">{{ file.name }}</div>
                <div class="file-size">{{ formatFileSize(file.size) }}</div>
              </div>
            </div>
            <button class="btn-icon" (click)="removeFile(i)">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Upload Progress -->
    <div class="progress-section" *ngIf="uploadProgress.length > 0">
      <div class="section-card">
        <div class="section-header">
          <h2 class="section-title">
            <mat-icon>trending_up</mat-icon>
            Upload Progress
          </h2>
        </div>
        
        <div class="progress-list">
          <div class="progress-item" *ngFor="let progress of uploadProgress">
            <div class="progress-info">
              <div class="progress-name">{{ progress.fileName }}</div>
              <div class="progress-status" [class]="progress.status">
                {{ progress.message }}
              </div>
            </div>
            <mat-icon class="progress-icon" [class]="progress.status">
              {{ getProgressIcon(progress.status) }}
            </mat-icon>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
